# 🔧 调试指南

## 问题：字数计数器不工作 / 问题显示"加载中..."

### 第一步：打开浏览器开发者工具

#### Chrome / Edge
1. 按 `F12` 或 `Cmd+Option+I` (Mac) / `Ctrl+Shift+I` (Windows)
2. 切换到 **Console** 标签

#### Safari (Mac)
1. 先启用开发者菜单：Safari → 偏好设置 → 高级 → 勾选"在菜单栏显示开发菜单"
2. 按 `Cmd+Option+C` 打开控制台

### 第二步：查看控制台输出

刷新页面后，你应该看到这些日志：

```
✅ 正常情况：
💝 应用启动
📋 初始化问答页面
✅ 问题加载成功: [某个问题]
🔗 绑定事件
✅ 输入框事件已绑定
✅ 提交按钮事件已绑定
✅ 历史记录按钮事件已绑定
📝 字数: 0/100
```

```
❌ 有问题的情况：
如果看到类似这些错误：
- ❌ 问题加载失败: ...
- ❌ 输入框元素未找到
- Uncaught ReferenceError: getRandomQuestion is not defined
- Failed to load resource: scripts/questions.js
```

### 第三步：根据错误类型解决

#### 错误 1：`getRandomQuestion is not defined`

**原因**：`questions.js` 文件没有加载

**解决方法**：
1. 检查文件是否存在：`scripts/questions.js`
2. 检查文件名拼写是否正确
3. 确保所有 `.js` 文件都在 `scripts` 文件夹里

#### 错误 2：字数不更新

**解决方法**：
1. 在控制台输入：`updateCharCount()`
2. 检查是否出现错误
3. 在输入框输入文字，看控制台是否有 `📝 字数: X/100` 的日志

#### 错误 3：问题显示"加载中..."

**解决方法**：
1. 检查控制台是否有 `✅ 问题加载成功` 的日志
2. 如果没有，检查 `scripts/questions.js` 文件是否存在
3. 手动刷新页面 (Cmd+R / Ctrl+R)

### 第四步：手动测试

在控制台依次输入以下命令测试：

```javascript
// 测试问题库是否加载
getRandomQuestion()
// 应该返回：{category: "...", question: "..."}

// 测试字数统计
document.getElementById('charCount')
// 应该返回：<span id="charCount">...</span>

// 测试输入框
document.getElementById('answerInput')
// 应该返回：<textarea id="answerInput">...</textarea>

// 手动触发字数更新
updateCharCount()
// 应该看到字数显示更新
```

## 常见问题解答

### Q1: 打开页面就看到"加载中..."

**A**: 问题文件没有正确加载

**解决步骤**：
1. 确认 `scripts/questions.js` 文件存在
2. 确认浏览器控制台没有红色错误
3. 尝试硬刷新：`Cmd+Shift+R` (Mac) / `Ctrl+Shift+R` (Windows)

### Q2: 输入文字但字数不变

**A**: 事件绑定失败

**解决步骤**：
1. 打开控制台，看是否有 `✅ 输入框事件已绑定`
2. 检查是否有 JavaScript 错误
3. 确认 `scripts/main.js` 正确加载

### Q3: 所有文件都在，但还是不工作

**A**: 可能是浏览器缓存问题

**解决步骤**：
1. 清空浏览器缓存
2. 硬刷新页面：`Cmd+Shift+R` (Mac) / `Ctrl+Shift+R` (Windows)
3. 或者尝试用无痕模式打开

### Q4: 在手机上不工作

**A**: 移动端调试

**iPhone Safari**：
1. 在 Mac 上：Safari → 开发 → [你的 iPhone] → [网页]
2. 查看控制台错误

**Android Chrome**：
1. 连接电脑
2. Chrome 地址栏输入：`chrome://inspect`
3. 查看设备上的网页

## 快速修复清单

依次检查以下项目：

- [ ] 文件结构是否正确
  ```
  try/
  ├── index.html
  └── scripts/
      ├── questions.js  ✓ 存在
      ├── cards.js      ✓ 存在  
      ├── storage.js    ✓ 存在
      ├── email.js      ✓ 存在
      └── main.js       ✓ 存在
  ```

- [ ] 打开浏览器控制台，看有没有红色错误

- [ ] 尝试硬刷新页面 (Cmd+Shift+R / Ctrl+Shift+R)

- [ ] 检查控制台是否有：
  - `💝 应用启动`
  - `✅ 问题加载成功`
  - `✅ 输入框事件已绑定`

- [ ] 在输入框输入文字，检查控制台是否有：
  - `📝 字数: X/100`

## 仍然无法解决？

### 完全重置

1. **备份数据**（如果有重要内容）：
   - 打开控制台
   - 输入：`JSON.stringify(exportAllData())`
   - 复制输出的文本保存

2. **清除所有本地数据**：
   ```javascript
   localStorage.clear()
   ```

3. **硬刷新页面**

4. **重新开始使用**

### 联系我

如果以上方法都无法解决，请提供以下信息：

1. **浏览器和版本**：例如 Chrome 120, Safari 17
2. **操作系统**：例如 macOS 14, Windows 11, iOS 17
3. **控制台的完整错误信息**（截图或复制文字）
4. **是在电脑还是手机上使用**

---

## 附录：完整的文件加载顺序

```html
<!-- index.html 底部 -->
<script src="scripts/questions.js"></script>   <!-- 1. 问题库 -->
<script src="scripts/cards.js"></script>       <!-- 2. 卡片库 -->
<script src="scripts/storage.js"></script>     <!-- 3. 存储功能 -->
<script src="scripts/email.js"></script>       <!-- 4. 邮件功能 -->
<script src="scripts/main.js"></script>        <!-- 5. 主逻辑 -->
```

加载顺序很重要！`main.js` 必须在最后加载。

---

**最后更新**：2025-10-17  
**目的**：帮助排查和解决常见问题 🔧

